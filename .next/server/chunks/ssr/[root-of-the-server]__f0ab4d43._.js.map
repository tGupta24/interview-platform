{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/ASUS/Desktop/Hackhazards%20AI/interview-platform/lib/vapi.sdk.ts"],"sourcesContent":["import Vapi from \"@vapi-ai/web\";\r\n\r\nexport const vapi = new Vapi(process.env.NEXT_PUBLIC_VAPI_WEB_TOKEN!);\r\n"],"names":[],"mappings":";;;AAAA;;AAEO,MAAM,OAAO,IAAI,mJAAA,CAAA,UAAI","debugId":null}},
    {"offset": {"line": 27, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/ASUS/Desktop/Hackhazards%20AI/interview-platform/components/Agent.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect, useRef } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport Image from \"next/image\";\r\nimport { Video, VideoOff } from \"lucide-react\"; // ðŸ‘ˆ icons\r\nimport { cn } from \"@/lib/utils\";\r\nimport { vapi } from \"@/lib/vapi.sdk\";\r\nimport { interviewer } from \"@/constants\";\r\nimport { createFeedback } from \"@/lib/actions/general.action\";\r\n\r\nenum CallStatus {\r\n  INACTIVE = \"INACTIVE\",\r\n  CONNECTING = \"CONNECTING\",\r\n  ACTIVE = \"ACTIVE\",\r\n  FINISHED = \"FINISHED\",\r\n}\r\n\r\ninterface SavedMessage {\r\n  role: \"user\" | \"system\" | \"assistant\";\r\n}\r\n\r\nconst Agent = ({\r\n  userName,\r\n  userId,\r\n  interviewId,\r\n  feedbackId,\r\n  type,\r\n  questions,\r\n}: AgentProps) => {\r\n  const router = useRouter();\r\n  const [callStatus, setCallStatus] = useState<CallStatus>(CallStatus.INACTIVE);\r\n  const [messages, setMessages] = useState<SavedMessage[]>([]);\r\n  const [isSpeaking, setIsSpeaking] = useState(false);\r\n  const [lastMessage, setLastMessage] = useState<string>(\"\");\r\n  const [cameraOn, setCameraOn] = useState(false);\r\n\r\n  const videoRef = useRef<HTMLVideoElement>(null);\r\n  const streamRef = useRef<MediaStream | null>(null);\r\n\r\n  const startCamera = async () => {\r\n    try {\r\n      const stream = await navigator.mediaDevices.getUserMedia({ video: true });\r\n      streamRef.current = stream;\r\n      if (videoRef.current) {\r\n        videoRef.current.srcObject = stream;\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error accessing camera:\", error);\r\n    }\r\n  };\r\n\r\n  const stopCamera = () => {\r\n    if (streamRef.current) {\r\n      streamRef.current.getTracks().forEach((track) => track.stop());\r\n      streamRef.current = null;\r\n    }\r\n    if (videoRef.current) {\r\n      videoRef.current.srcObject = null;\r\n    }\r\n  };\r\n\r\n  const toggleCamera = () => {\r\n    if (cameraOn) {\r\n      stopCamera();\r\n    } else {\r\n      startCamera();\r\n    }\r\n    setCameraOn(!cameraOn);\r\n  };\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      stopCamera();\r\n    };\r\n  }, []);\r\n\r\n  const handleCall = async () => {\r\n    setCallStatus(CallStatus.CONNECTING);\r\n    if (type === \"generate\") {\r\n      await vapi.start(process.env.NEXT_PUBLIC_VAPI_WORKFLOW_ID!, {\r\n        variableValues: {\r\n          username: userName,\r\n          userid: userId,\r\n        },\r\n      });\r\n    } else {\r\n      let formattedQuestions = \"\";\r\n      if (questions) {\r\n        formattedQuestions = questions.map((question) => `- ${question}`).join(\"\\n\");\r\n      }\r\n      await vapi.start(interviewer, {\r\n        variableValues: {\r\n          questions: formattedQuestions,\r\n        },\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleDisconnect = () => {\r\n    setCallStatus(CallStatus.FINISHED);\r\n    vapi.stop();\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"call-view\">\r\n        <div className=\"card-interviewer\">\r\n          <div>\r\n            <Image\r\n              src=\"/logo2.png\"\r\n              alt=\"profile-image\"\r\n              width={65}\r\n              height={54}\r\n              className=\"object-cover\"\r\n            />\r\n            {isSpeaking && <span className=\"animate-speak\" />}\r\n          </div>\r\n          <h3>AI-Interviewer</h3>\r\n        </div>\r\n\r\n        <div className=\"card-border\">\r\n          <div className=\"card-content relative flex flex-col items-center gap-4\">\r\n            {/* Profile Picture / Video */}\r\n            {cameraOn ? (\r\n              <video\r\n                ref={videoRef}\r\n                autoPlay\r\n                muted\r\n                playsInline\r\n                className=\"rounded-2xl object-cover size-[250px]\"\r\n              />\r\n            ) : (\r\n              <Image\r\n                src=\"/userProfile.jpg\"\r\n                alt=\"profile-image\"\r\n                width={600}\r\n                height={600}\r\n                className=\"rounded-full object-cover size-[160px]\"\r\n              />\r\n            )}\r\n            <h3>{userName}</h3>\r\n\r\n            {/* Camera Toggle Icon Button */}\r\n            <button\r\n              onClick={toggleCamera}\r\n              className=\"absolute bottom-2 right-2 bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-full\"\r\n            >\r\n              {cameraOn ? <VideoOff size={20} /> : <Video size={20} />}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Transcript Section */}\r\n      {messages.length > 0 && (\r\n        <div className=\"transcript-border\">\r\n          <div className=\"transcript\">\r\n            <p\r\n              key={lastMessage}\r\n              className={cn(\r\n                \"transition-opacity duration-500 opacity-0\",\r\n                \"animate-fadeIn opacity-100\"\r\n              )}\r\n            >\r\n              {lastMessage}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Call / End Call Button */}\r\n      <div className=\"w-full flex justify-center mt-8\">\r\n        {callStatus !== \"ACTIVE\" ? (\r\n          <button className=\"relative btn-call\" onClick={handleCall}>\r\n            <span\r\n              className={cn(\r\n                \"absolute animate-ping rounded-full opacity-75\",\r\n                callStatus !== \"CONNECTING\" && \"hidden\"\r\n              )}\r\n            />\r\n            <span className=\"relative\">\r\n              {callStatus === \"INACTIVE\" || callStatus === \"FINISHED\"\r\n                ? \"Call\"\r\n                : \". . .\"}\r\n            </span>\r\n          </button>\r\n        ) : (\r\n          <button className=\"btn-disconnect\" onClick={handleDisconnect}>\r\n            End\r\n          </button>\r\n        )}\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Agent;\r\n"],"names":[],"mappings":"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","debugId":null}}]
}